# GitHub Actions Workflow for Automated Meta API Sync
#
# To use:
# 1. Rename this file to .github/workflows/meta-sync.yml
# 2. Create API route at app/api/sync/route.ts (see README)
# 3. Add SYNC_SECRET to GitHub repository secrets
# 4. Push to GitHub
#
# This will run sync every 6 hours automatically

name: Meta API Sync

on:
  schedule:
    # Run every 6 hours (0:00, 6:00, 12:00, 18:00 UTC)
    - cron: '0 */6 * * *'

  # Allow manual triggering from GitHub UI
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - name: Trigger Meta Sync
        run: |
          curl -X POST ${{ secrets.APP_URL }}/api/sync \
            -H "Authorization: Bearer ${{ secrets.SYNC_SECRET }}" \
            -H "Content-Type: application/json" \
            -d '{}' \
            -f -s -S

      - name: Check sync status
        if: failure()
        run: |
          echo "Sync failed! Check application logs."
          exit 1

# Required Secrets:
# - APP_URL: Your Vercel deployment URL (e.g., https://your-app.vercel.app)
# - SYNC_SECRET: Secret token for API authentication (generate with: openssl rand -base64 32)
